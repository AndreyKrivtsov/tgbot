# üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram –ë–æ—Ç–∞

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [–û–±—â–∏–π –æ–±–∑–æ—Ä](#–æ–±—â–∏–π-–æ–±–∑–æ—Ä)
- [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-–ø—Ä–∏–Ω—Ü–∏–ø—ã)
- [–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–°–µ—Ä–≤–∏—Å—ã –±–æ—Ç–∞](#—Å–µ—Ä–≤–∏—Å—ã-–±–æ—Ç–∞)
- [–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞](#–ª–æ–≥–∏–∫–∞-—Ä–∞–±–æ—Ç—ã-–±–æ—Ç–∞)
- [API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#api-–∏-–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
- [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)
- [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-–∏-—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ)

---

## üéØ –û–±—â–∏–π –æ–±–∑–æ—Ä

–≠—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è, –º–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Telegram –±–æ—Ç–∞ —Å —Ç—Ä–µ–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
1. **üîê –ö–∞–ø—á–∞** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏
2. **üõ°Ô∏è –ê–Ω—Ç–∏—Å–ø–∞–º** - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π —á–µ—Ä–µ–∑ AI
3. **ü§ñ AI –ß–∞—Ç** - –æ–±—â–µ–Ω–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ Gemini API

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **–Ø–∑—ã–∫**: TypeScript
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: Node.js
- **Telegram API**: GramIO
- **AI**: Google Gemini 2.5
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: Fastify
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: PostgreSQL (–ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è)
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: Dependency Injection + Service-oriented

---

## üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. **Dependency Injection (DI)**
```typescript
// –í—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏–Ω–∂–µ–∫—Ç–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä
class TelegramBotService {
  constructor(
    private config: AppConfig,
    private logger: Logger,
    private dependencies: {
      captchaService?: CaptchaService
      antiSpamService?: AntiSpamService
      aiChatService?: AIChatService
    }
  ) {}
}
```

### 2. **Service Lifecycle Management**
–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `IService`:
```typescript
interface IService {
  initialize?(): Promise<void>  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
  start?(): Promise<void>       // –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
  stop?(): Promise<void>        // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
  dispose?(): Promise<void>     // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
}
```

### 3. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**
- **–ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å** –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –æ–¥–Ω—É —Ñ—É–Ω–∫—Ü–∏—é
- **Container** —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º
- **Application** –æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é —Å–µ—Ä–≤–∏—Å–æ–≤
- **App** —É–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—É—Å–∫–æ–º/–æ—Å—Ç–∞–Ω–æ–≤–∫–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 4. **–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ –æ—á–µ—Ä–µ–¥–∏**
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–µ
- AI –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –æ—á–µ—Ä–µ–¥—å
- Throttling –∏ rate limiting

---

## üì¶ –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
app/src/
‚îú‚îÄ‚îÄ core/                    # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ Container.ts         # DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ Application.ts       # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ services/                # –ë–∏–∑–Ω–µ—Å-—Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ TelegramBotService.ts    # –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å –±–æ—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ CaptchaService.ts        # –°–µ—Ä–≤–∏—Å –∫–∞–ø—á–∏
‚îÇ   ‚îú‚îÄ‚îÄ AntiSpamService.ts       # –°–µ—Ä–≤–∏—Å –∞–Ω—Ç–∏—Å–ø–∞–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ AIChatService.ts         # –°–µ—Ä–≤–∏—Å AI —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ DatabaseService.ts       # –°–µ—Ä–≤–∏—Å –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ CacheService.ts          # –°–µ—Ä–≤–∏—Å –∫—ç—à–∞
‚îÇ   ‚îú‚îÄ‚îÄ AIService.ts             # –°–µ—Ä–≤–∏—Å AI API
‚îÇ   ‚îî‚îÄ‚îÄ WebServerService.ts      # –í–µ–±-—Å–µ—Ä–≤–µ—Ä
‚îú‚îÄ‚îÄ bot/                     # –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ –±–æ—Ç–∞ (—Ä–µ—Ñ–µ—Ä–µ–Ω—Å)
‚îú‚îÄ‚îÄ helpers/                 # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ repository/              # –°–ª–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ web/                     # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îú‚îÄ‚îÄ app.ts                   # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ index.ts                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îî‚îÄ‚îÄ config.ts                # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```

### üîß Container (DI –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)
**–§–∞–π–ª**: `app/src/core/Container.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º —Å–µ—Ä–≤–∏—Å–æ–≤

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
```typescript
// –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞ –∏–ª–∏ —Ñ–∞–±—Ä–∏–∫–∏
container.register("serviceName", serviceInstance | factory)

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ (—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
const service = container.get<ServiceType>("serviceName")

// –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
const service = await container.getAsync<ServiceType>("serviceName")

// –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª
await container.initialize() // –°–æ–∑–¥–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ + initialize()
await container.start()      // –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (start())
await container.stop()       // –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ (stop())
await container.dispose()    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ (dispose())
```

### üéØ Application (–û—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä)
**–§–∞–π–ª**: `app/src/core/Application.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ

**–ü–æ—Ä—è–¥–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏**:
1. **Core services**: Repository, Database, Cache
2. **Infrastructure services**: AI Service
3. **Business services**: Captcha, AntiSpam, AI Chat
4. **Web services**: Telegram Bot, Web Server

---

## ü§ñ –°–µ—Ä–≤–∏—Å—ã –±–æ—Ç–∞

### 1. üîê CaptchaService
**–§–∞–π–ª**: `app/src/services/CaptchaService.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∑–∞–¥–∞—á–∞–º–∏

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**:
```typescript
interface CaptchaChallenge {
  question: number[]  // [5, 3] –¥–ª—è "5 + 3 = ?"
  answer: number      // 8
  options: number[]   // [6, 8, 9, 11] - 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –æ—Ç–≤–µ—Ç–∞
}

interface RestrictedUser {
  userId: number
  chatId: number
  questionId: number      // ID —Å–æ–æ–±—â–µ–Ω–∏—è —Å –∫–∞–ø—á–µ–π
  answer: number          // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
  username?: string
  firstname: string
  timestamp: number       // –í—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞–ø—á–∏
  isAnswered: boolean     // –§–ª–∞–≥ –æ—Ç–≤–µ—Ç–∞
}
```

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `generateCaptcha()` - –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∑–∞–¥–∞—á–∏
- `addRestrictedUser()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ
- `validateAnswer()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `startTimeoutMonitoring()` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ç–∞–π–º–∞—É—Ç–æ–≤ (60 —Å–µ–∫—É–Ω–¥)

**–ö–æ–ª–±—ç–∫–∏ –¥–ª—è TelegramBotService**:
- `onCaptchaTimeout` - —Ç–∞–π–º–∞—É—Ç –∫–∞–ø—á–∏
- `onCaptchaSuccess` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
- `onCaptchaFailed` - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç

### 2. üõ°Ô∏è AntiSpamService
**–§–∞–π–ª**: `app/src/services/AntiSpamService.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–ø–∞–º-—Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ø–µ—Ä–≤—ã—Ö 5 —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**:
```typescript
interface UserSpamCheck {
  userId: number
  messageCount: number    // –°—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π (–º–∞–∫—Å 5)
  isChecking: boolean     // –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ–π AI –ø—Ä–æ–≤–µ—Ä–∫–∏
  lastCheckTime: number   // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
}
```

**–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≤–µ—Ä–∫–∏**:
1. **–°—á–µ—Ç—á–∏–∫ —Å–æ–æ–±—â–µ–Ω–∏–π**: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π
2. **–ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã**:
   - –î–ª–∏–Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è > 1000 —Å–∏–º–≤–æ–ª–æ–≤
   - –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã (–±–æ–ª–µ–µ 5 –ø–æ–¥—Ä—è–¥)
   - –ë–æ–ª–µ–µ 2 —Å—Å—ã–ª–æ–∫
   - –°–ø–∞–º-—Å–ª–æ–≤–∞: "–∑–∞—Ä–∞–±–æ—Ç–æ–∫", "–¥–µ–Ω—å–≥–∏ –±—ã—Å—Ç—Ä–æ", "–±–µ–∑ –≤–ª–æ–∂–µ–Ω–∏–π" –∏ —Ç.–¥.
3. **AI –ø—Ä–æ–≤–µ—Ä–∫–∞**: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Gemini —Å –ø—Ä–æ–º–ø—Ç–æ–º –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `checkMessage()` - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
- `performBasicChecks()` - –±–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã
- `checkWithAI()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ AI
- `cleanupOldRecords()` - –æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

### 3. ü§ñ AIChatService
**–§–∞–π–ª**: `app/src/services/AIChatService.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –±–æ—Ç—É –∏ –æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Gemini API

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã**:
```typescript
interface ChatContext {
  chatId: string
  messages: ChatMessage[]     // –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π (–º–∞–∫—Å 20)
  lastActivity: number
  requestCount: number        // –û–±—â–∏–π —Å—á–µ—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
  dailyRequestCount: number   // –î–Ω–µ–≤–Ω–æ–π —Å—á–µ—Ç—á–∏–∫ (–ª–∏–º–∏—Ç 1500)
  lastDailyReset: number     // –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–±—Ä–æ—Å–∞
}

interface MessageQueue {
  id: number
  message: string
  contextId: string
  timestamp: number
  retryCount: number         // –ü–æ–ø—ã—Ç–∫–∏ –ø–æ–≤—Ç–æ—Ä–∞ (–º–∞–∫—Å 3)
}
```

**–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π**:
- `@botusername` - –ø—Ä—è–º–æ–µ —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ
- `"—ç–π –±–æ—Ç"`, `"–∞–ª—å—Ç—Ä–æ–Ω"` - –∫–ª—é—á–µ–≤—ã–µ —Ñ—Ä–∞–∑—ã
- Reply –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤**:
1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤**: 1500 –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å –Ω–∞ —á–∞—Ç
2. **–û—á–µ—Ä–µ–¥—å**: –ú–∞–∫—Å–∏–º—É–º 8 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏
3. **Throttling**: 3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ AI
4. **–ö–æ–Ω—Ç–µ–∫—Å—Ç**: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–∏–∞–ª–æ–≥–∞ (20 —Å–æ–æ–±—â–µ–Ω–∏–π)
5. **Retry**: –î–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç–æ–¥—ã**:
- `isBotMention()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –±–æ—Ç—É
- `processMessage()` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –æ—á–µ—Ä–µ–¥—å
- `startQueueProcessor()` - –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏
- `throttledAIRequest()` - –∑–∞–ø—Ä–æ—Å –∫ AI —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏

**–ö–æ–ª–±—ç–∫–∏ –¥–ª—è TelegramBotService**:
- `onMessageResponse` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞
- `onTypingStart/Stop` - –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –Ω–∞–±–æ—Ä–∞ —Ç–µ–∫—Å—Ç–∞

### 4. üì± TelegramBotService
**–§–∞–π–ª**: `app/src/services/TelegramBotService.ts`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ì–ª–∞–≤–Ω—ã–π —Å–µ—Ä–≤–∏—Å, –æ–±—ä–µ–¥–∏–Ω—è—é—â–∏–π –≤—Å—é –ª–æ–≥–∏–∫—É –±–æ—Ç–∞

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π**:
```typescript
// –ù–æ–≤—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏
bot.on("chat_member", handleChatMember)
bot.on("new_chat_members", handleNewChatMembers)
bot.on("left_chat_member", handleLeftChatMember)

// –°–æ–æ–±—â–µ–Ω–∏—è –∏ –∫–æ–ª–±—ç–∫–∏
bot.on("message", handleMessage)
bot.on("callback_query", handleCallbackQuery)
```

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤**:
- **CaptchaService**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞–ø—á–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **AntiSpamService**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- **AIChatService**: –û–±—Ä–∞–±–æ—Ç–∫–∞ AI —á–∞—Ç–∞

---

## üîÑ –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è –∫ —á–∞—Ç—É

**–ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º**:

1. **–°–æ–±—ã—Ç–∏–µ**: `chat_member` —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º `left -> member`
2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–∞–ø—á–∏**:
   ```typescript
   const question = [randomNumber(1,10), randomNumber(1,10)]
   const answer = question[0] + question[1]
   const options = [wrongAnswer1, wrongAnswer2, wrongAnswer3, answer] // –ø–µ—Ä–µ–º–µ—à–∞–Ω—ã
   ```
3. **–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è**:
   ```
   "@username, –¥–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üéâ
   
   –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ —á–∞—Ç—É —Ä–µ—à–∏—Ç–µ –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–∏–º–µ—Ä:
   
   5 + 3 = ?
   
   [6] [8] [9] [11]  // InlineKeyboard
   ```
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø—Ä–∞–≤**:
   ```typescript
   restrictChatMember({
     can_send_messages: false,
     can_send_audios: false,
     // ... –≤—Å–µ –ø—Ä–∞–≤–∞ false
   })
   ```
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**: –ß–µ—Ä–µ–∑ 60 —Å–µ–∫—É–Ω–¥ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –±–∞–Ω –µ—Å–ª–∏ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ

**–ê–Ω—Ç–∏—Å–ø–∞–º –ø—Ä–æ–≤–µ—Ä–∫–∞**:
1. **–ë–∞–∑–æ–≤—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã**:
   - –î–ª–∏–Ω–∞ > 1000 —Å–∏–º–≤–æ–ª–æ–≤ ‚Üí —Å–ø–∞–º
   - –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã: `/(.)\1{5,}/` ‚Üí —Å–ø–∞–º
   - –ë–æ–ª–µ–µ 2 —Å—Å—ã–ª–æ–∫ ‚Üí —Å–ø–∞–º
   - –°–ø–∞–º-—Å–ª–æ–≤–∞ –∏–∑ —Å–ø–∏—Å–∫–∞ ‚Üí —Å–ø–∞–º

2. **AI –ø—Ä–æ–≤–µ—Ä–∫–∞**:
   ```typescript
   const prompt = `–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏ –æ–ø—Ä–µ–¥–µ–ª–∏, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –æ–Ω–æ —Å–ø–∞–º–æ–º. 
   –û—Ç–≤–µ—á–∞–π —Ç–æ–ª—å–∫–æ "–°–ü–ê–ú" –∏–ª–∏ "–ù–ï –°–ü–ê–ú":
   
   –°–æ–æ–±—â–µ–Ω–∏–µ: "${message}"
   
   –ö—Ä–∏—Ç–µ—Ä–∏–∏ —Å–ø–∞–º–∞:
   - –†–µ–∫–ª–∞–º–∞ —Ç–æ–≤–∞—Ä–æ–≤/—É—Å–ª—É–≥
   - –ü—Ä–∏–∑—ã–≤—ã –∫ –ø–µ—Ä–µ—Ö–æ–¥–∞–º –ø–æ —Å—Å—ã–ª–∫–∞–º
   - –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∑–∞—Ä–∞–±–æ—Ç–∫–∞
   - –ù–∞–≤—è–∑—á–∏–≤–∞—è —Ä–µ–∫–ª–∞–º–∞
   - –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–æ
   - –ü–æ–≤—Ç–æ—Ä—è—é—â–∏–π—Å—è –∫–æ–Ω—Ç–µ–Ω—Ç`
   ```

**AI —á–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞**:
- `@botusername` –≤ —Ç–µ–∫—Å—Ç–µ
- –û—Ç–≤–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –±–æ—Ç–∞ (reply)
- –†–µ–≥–µ–∫—Å—ã: `/^—ç–π.{0,3}–±–æ—Ç\W?/i`, `/^–∞–ª—å—Ç—Ä–æ–Ω/gi`, `/^–±–æ—Ç[,\s]/i`

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: AI —á–∞—Ç –æ–±—Ä–∞–±–æ—Ç–∫–∞

**–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è AI**:
```typescript
const prepareContextualMessage = (message, username, firstName) => {
  const date = new Date().toISOString().replace(/:\d+\.\d+Z/gi, "").replace("T", " ")
  const userInfo = firstName ? 
    (username ? `@${username}][${firstName}` : `${firstName}`) :
    (username ? `@${username}` : "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å")
  
  return `[${date}][${userInfo}] –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–µ–±—è: ${message}`
}
// –†–µ–∑—É–ª—å—Ç–∞—Ç: "[2025-06-05 20:30][[@john][John Doe] –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ç–µ–±—è: –ü—Ä–∏–≤–µ—Ç, –∫–∞–∫ –¥–µ–ª–∞?"
```

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥—å—é**:
- –ú–∞–∫—Å–∏–º—É–º 8 —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –æ—á–µ—Ä–µ–¥–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –æ–¥–Ω–æ–º—É —Å –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º 1 —Å–µ–∫—É–Ω–¥–∞
- Throttling: 3 —Å–µ–∫—É–Ω–¥—ã –º–µ–∂–¥—É AI –∑–∞–ø—Ä–æ—Å–∞–º–∏
- Retry: –¥–æ 3 –ø–æ–ø—ã—Ç–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

**–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º**:
- –ò—Å—Ç–æ—Ä–∏—è –¥–æ 20 —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ —á–∞—Ç
- –ê–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- –î–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç: 1500 –∑–∞–ø—Ä–æ—Å–æ–≤ (—Å–±—Ä–æ—Å –≤ 00:00)

---

## üåê API –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### WebServerService
**–§–∞–π–ª**: `app/src/services/WebServerService.ts`

**Endpoints**:
```typescript
GET  /api/health           // –°—Ç–∞—Ç—É—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
GET  /api/config           // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –±–æ—Ç–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª—è)
POST /api/config           // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
GET  /api/stats            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
GET  /admin                // Telegram WebApp –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
```

### Telegram WebApp
**URL**: `https://your-domain.com/admin`

**–§—É–Ω–∫—Ü–∏–∏**:
- üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ø—á–∏ (–≤–∫–ª/–≤—ã–∫–ª, —Ç–∞–π–º–∞—É—Ç)
- üõ°Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω—Ç–∏—Å–ø–∞–º–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π)
- ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ AI —á–∞—Ç–∞ (–¥–Ω–µ–≤–Ω–æ–π –ª–∏–º–∏—Ç, –≤–∫–ª/–≤—ã–∫–ª)
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤—Å–µ–º —Å–µ—Ä–≤–∏—Å–∞–º

**–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —Å–æ–∑–¥–∞—Ç–µ–ª—é –±–æ—Ç–∞ (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ Telegram initData)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –§–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–§–∞–π–ª**: `app/src/config.ts`

```typescript
export const config = {
  // –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
  NODE_ENV: process.env.NODE_ENV || "development",
  BOT_TOKEN: process.env.BOT_TOKEN!,
  
  // –í–µ–±-—Å–µ—Ä–≤–µ—Ä
  WEB_PORT: parseInt(process.env.WEB_PORT || "3000"),
  WEB_HOST: process.env.WEB_HOST || "0.0.0.0",
  
  // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
  DATABASE_URL: process.env.DATABASE_URL || "postgresql://...",
  REDIS_URL: process.env.REDIS_URL || "redis://localhost:6379",
  
  // AI API
  AI_API_KEY: process.env.AI_API_KEY || "",
  AI_API_THROTTLE: parseInt(process.env.AI_API_THROTTLE || "3000"),
  
  // –ß–∞—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  DEFAULT_CHAT_ID: parseInt(process.env.DEFAULT_CHAT_ID || "0"),
  
  // –ê–¥–º–∏–Ω
  ADMIN_USERNAME: process.env.ADMIN_USERNAME || "",
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ
NODE_ENV=development
BOT_TOKEN=your_telegram_bot_token

# –í–µ–±-—Å–µ—Ä–≤–µ—Ä
WEB_PORT=3000
WEB_HOST=0.0.0.0

# AI
AI_API_KEY=your_gemini_api_key
AI_API_THROTTLE=3000

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_URL=postgresql://user:pass@host:5432/db
REDIS_URL=redis://localhost:6379

# –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞
DEFAULT_CHAT_ID=-1001234567890
ADMIN_USERNAME=@admin_username
```

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞

1. **–°–æ–∑–¥–∞—Ç—å –∫–ª–∞—Å—Å —Å–µ—Ä–≤–∏—Å–∞**:
```typescript
// app/src/services/NewService.ts
import type { IService } from "../core/Container.js"

export class NewService implements IService {
  async initialize(): Promise<void> {
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
  }

  async start(): Promise<void> {
    // –ó–∞–ø—É—Å–∫
  }

  async stop(): Promise<void> {
    // –û—Å—Ç–∞–Ω–æ–≤–∫–∞
  }

  async dispose(): Promise<void> {
    // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
  }
}
```

2. **–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Application**:
```typescript
// app/src/core/Application.ts
this.container.register("newService", async () => {
  const { NewService } = await import("../services/NewService.js")
  return new NewService(this.config, this.logger)
})
```

3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –¥—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö**:
```typescript
// –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
const newService = await this.container.getAsync("newService")
```

### –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –±–æ—Ç–∞

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏–π**:
```typescript
// –í TelegramBotService.setupEventHandlers()
this.bot.on("new_event", (context) => {
  this.handleNewEvent(context)
})

private async handleNewEvent(context: any): Promise<void> {
  // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞
}
```

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã**:
```typescript
// –í TelegramBotService.setupEventHandlers()
this.bot.command("newcommand", (context) => {
  this.handleNewCommand(context)
})
```

### –û—Ç–ª–∞–¥–∫–∞ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**:
```typescript
this.logger.d("Debug message")     // DEBUG
this.logger.i("Info message")      // INFO  
this.logger.w("Warning message")   // WARN
this.logger.e("Error message")     // ERROR
```

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤**:
```typescript
// –ö–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
const stats = service.getStats()

// –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ CaptchaService:
{
  restrictedUsers: 5,
  isMonitoring: true,
  serviceStatus: "active"
}
```

**Health checks**:
```typescript
const isHealthy = service.isHealthy()
// true/false - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞
```

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤**:
```typescript
// tests/services/CaptchaService.test.ts
describe("CaptchaService", () => {
  it("should generate valid captcha", () => {
    const captchaService = new CaptchaService(config, logger)
    const captcha = captchaService.generateCaptcha()
    
    expect(captcha.question).toHaveLength(2)
    expect(captcha.options).toHaveLength(4)
    expect(captcha.options).toContain(captcha.answer)
  })
})
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**Docker**:
```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY dist/ ./dist/
CMD ["npm", "start"]
```

**Docker Compose**:
```yaml
version: '3.8'
services:
  bot:
    build: .
    environment:
      - BOT_TOKEN=${BOT_TOKEN}
      - AI_API_KEY=${AI_API_KEY}
    depends_on:
      - postgres
      - redis
  
  postgres:
    image: postgres:15
    environment:
      POSTGRES_DB: botdb
      POSTGRES_USER: botuser
      POSTGRES_PASSWORD: botpass
  
  redis:
    image: redis:7-alpine
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- **–ö–∞–ø—á–∞**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∫–∞–ø—á, –ø—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π
- **–ê–Ω—Ç–∏—Å–ø–∞–º**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–æ—Ü–µ–Ω—Ç —Å–ø–∞–º–∞
- **AI —á–∞—Ç**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ –¥–µ–Ω—å, —Ä–∞–∑–º–µ—Ä –æ—á–µ—Ä–µ–¥–∏, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞
- **–°–∏—Å—Ç–µ–º–∞**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏, –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫

### –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```
[05.06.2025 20:24:43][App][INFO]: üéâ Application is running!
[05.06.2025 20:24:45][App][INFO]: ‚úÖ Telegram bot started: @test_ai_group_bot
[05.06.2025 20:24:45][App][INFO]: üåç Environment: development
[05.06.2025 20:24:45][App][INFO]: ü§ñ Bot mode: enabled
```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫
```bash
# 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É—Å—Ç–∞–Ω–æ–≤–∫–∞
git clone <repo>
cd tgbot/app
npm install

# 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
cp .env.example .env
# –ó–∞–ø–æ–ª–Ω–∏—Ç—å BOT_TOKEN, AI_API_KEY

# 3. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫
npm run build
npm start
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è
1. **–ù–∞—á–Ω–∏—Ç–µ —Å**: `app/src/index.ts` ‚Üí `app.ts` ‚Üí `core/Application.ts`
2. **–û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞**: `services/TelegramBotService.ts`
3. **–§—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞**: `services/CaptchaService.ts`, `AntiSpamService.ts`, `AIChatService.ts`
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: `config.ts` –∏ `.env`

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
```bash
npm run build      # –°–±–æ—Ä–∫–∞ TypeScript
npm start          # –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run dev        # –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å watch mode
npm test           # –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤
npm run lint       # –õ–∏–Ω—Ç–∏–Ω–≥ –∫–æ–¥–∞
```

---

## üìà –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è

### –ö—Ä–∞—Ç–∫–æ—Å—Ä–æ—á–Ω—ã–µ –∑–∞–¥–∞—á–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ä–µ–∞–ª—å–Ω—ã–º Gemini API
- [ ] –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ PostgreSQL –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤
- [ ] –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

### –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ –ø–ª–∞–Ω—ã  
- [ ] –ú—É–ª—å—Ç–∏–≥—Ä—É–ø–ø–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞
- [ ] –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã
- [ ] –ö–∞—Å—Ç–æ–º–∏–∑–∏—Ä—É–µ–º—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∞–Ω—Ç–∏—Å–ø–∞–º–∞
- [ ] Telegram Mini App –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: 05.06.2025*  
*–í–µ—Ä—Å–∏—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã: 2.0*  
*–ê–≤—Ç–æ—Ä: AI Assistant + Development Team*